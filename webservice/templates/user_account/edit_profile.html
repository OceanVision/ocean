{% extends 'base/index.html' %}
{% block body %}

<div id="editProfileForm" class="container form" data-center_h="true" data-center_v="true" data-transit="true">

    <div class="leaflet"><p class="header">EDIT PROFILE</p></div>
    <form action="/edit_profile" method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <input type="submit" value="Submit" />
    </form>

    <div class="leaflet"><p class="header">CHANGE PASSWORD</p></div>
    <input id="currentPassword" type="text" value="current password" 
        data-value="current password" data-type="password"><br>
    <input id="newPassword" type="text" value="new password"
        data-value="new password" data-type="password"><br>
    <input id="retypedPassword" type="text" value="retype password" 
        data-value="retype password" data-type="password"><br>
    <a class="submit" href="javascript:changePassword()">submit</a>
</div>

<script type="text/javascript">

    //TODO: make synchronous
    var changePassword = function() {
        $("#editProfileForm a.submit").addClass("disabled");
        main.changePassword($("#currentPassword").val(), $("#newPassword").val(), $("#retypedPassword").val());
        $("#editProfileForm a.submit").removeClass("disabled");
    };

    // Trigger changePassword when ENTER pressed
    $("#editProfileForm input")
        .off("keypress")
        .on("keypress", function (e) {
            if (e.which == 13) {
                changePassword();
            }
        });
</script>

{% endblock %}
